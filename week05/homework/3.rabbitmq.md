# 作业三：请用自己的语言描述如下问题：

- 在你目前的工作场景中，哪个业务适合使用 rabbitmq？ 引入 rabbitmq 主要解决什么问题?（非相关工作可以以设计淘宝购物和结账功能为例来描述）
- 如何避免消息重复投递或重复消费？
- 交换机 fanout、direct、topic 有什么区别？
- 架构中引入消息队列是否利大于弊？你认为消息队列有哪些缺点？
#### 作业 3 提示：
1. 服务间异步通信
2. 顺序消费
3. 定时任务
4. 流量削峰
5. 解耦
6. 利用消息队列将高并发访问变为串行操作
7. 异步下单
8. 消息队列持久化


## 如何避免消息重复投递或重复消费？
### 消息队列常见问题

#### 如何保证书屋在分布式消息队列的一致性?
- 消息队列开启事务(半消息)
- 在任何一个系统上,都没有完美的解决方案
- 关于rabbitmq,kafka都有现成的解决方案

#### 如何保证消息不会丢?
- 不可能完全实现的事情
- 生产者使用TCC方式
- 消费者使用序号的方式,当序号不连续时,实现报警

#### 如何处理重复消费?
- 幂等性解决
- 数据库唯一约束
- 送达方式:最多一次


## 交换机 fanout、direct、topic 有什么区别？
[【RabbitMQ】——三种Exchange模式（Fanout、Direct、Topic)
](https://blog.csdn.net/hao134838/article/details/71710067)

[direct、topic、fanout的使用以及区别](https://tuonioooo-notebook.gitbook.io/high-concurrent-queue/rabbitmq/directtopicfanoutde-shi-yong-yi-ji-qu-bie)
- direct：交换机不起到条件分发的作用，生产者“直接”将数据写入队列，由单个消费者直接消费，或者多个消费者轮询消费。
- fanout：交换机根据队列的订阅情况分发数据。
- topic：交换机根据数据的key以及队列属性，将对应数据发送给对应队列。

### 架构中引入消息队列是否利大于弊？你认为消息队列有哪些缺点？
缺点: 消息处理速度过慢,不适用于客户直接使用的api


### 在你目前的工作场景中，哪个业务适合使用 rabbitmq？ 引入 rabbitmq 主要解决什么问题?（非相关工作可以以设计淘宝购物和结账功能为例来描述）

持续交付业务: 消息通知可以使用队列方式,消费者可以设置为多个,分别对应sms,mail,im
工作流业务: 小并发下不建议使用队列解决,还是建议使用api+数据库方式解决.